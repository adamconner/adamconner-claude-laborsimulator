<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Labor Market Impact Simulator</title>
    <link rel="stylesheet" href="public/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar Overlay (for mobile) -->
        <div class="sidebar-overlay" id="sidebarOverlay" onclick="closeMobileMenu()"></div>

        <!-- Mobile Floating Action Button -->
        <button class="mobile-fab" onclick="openMobileMenu()" aria-label="Configure scenario" title="Configure Scenario">
            ‚öôÔ∏è
        </button>

        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <button class="sidebar-close" id="sidebarClose" onclick="closeMobileMenu()" aria-label="Close menu">&times;</button>
            <div class="sidebar-header">
                <h2>AI Labor Market Simulator</h2>
                <p style="font-size: 0.875rem; color: var(--gray-400); margin-top: 8px;">
                    Model AI's impact on employment
                </p>
            </div>

            <!-- Reset All Button -->
            <div class="sidebar-section" style="padding-top: 0;">
                <button class="btn btn-outline btn-block" onclick="resetEverything()" style="border-color: var(--danger); color: var(--danger);">
                    Reset Everything
                </button>
            </div>

            <!-- Scenario Configuration -->
            <div class="sidebar-section">
                <h3>Scenario Configuration</h3>

                <div class="form-group">
                    <label>Scenario Name</label>
                    <input type="text" id="scenarioName" value="My Scenario" placeholder="Enter scenario name">
                </div>

                <div class="form-group">
                    <label>Target Year</label>
                    <select id="targetYear">
                        <option value="2026">2026 (2 years)</option>
                        <option value="2027">2027 (3 years)</option>
                        <option value="2028">2028 (4 years)</option>
                        <option value="2029" selected>2029 (5 years)</option>
                        <option value="2034">2034 (10 years)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Target Unemployment Rate: <span id="urValue">10.0</span>%</label>
                    <input type="range" id="targetUR" min="2" max="40" step="0.5" value="10">
                </div>

                <div class="form-group">
                    <label>AI Adoption Rate: <span id="aiValue">70</span>%</label>
                    <input type="range" id="aiAdoption" min="20" max="100" step="5" value="70">
                </div>

                <div class="form-group">
                    <label>Automation Pace</label>
                    <select id="automationPace">
                        <option value="slow">Slow</option>
                        <option value="moderate" selected>Moderate</option>
                        <option value="fast">Fast</option>
                        <option value="accelerating">Accelerating</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Adoption Curve</label>
                    <select id="adoptionCurve">
                        <option value="linear">Linear</option>
                        <option value="s_curve" selected>S-Curve (Logistic)</option>
                        <option value="exponential">Exponential</option>
                    </select>
                </div>
            </div>

            <!-- Preset Scenarios -->
            <div class="sidebar-section">
                <h3>Preset Scenarios</h3>
                <button class="preset-btn" onclick="loadPreset('moderate')">
                    <div class="title">Moderate Disruption</div>
                    <div class="desc">8% unemployment, gradual AI adoption</div>
                </button>
                <button class="preset-btn" onclick="loadPreset('rapid')">
                    <div class="title">Rapid Automation</div>
                    <div class="desc">12% unemployment, accelerated AI</div>
                </button>
                <button class="preset-btn" onclick="loadPreset('managed')">
                    <div class="title">Managed Transition</div>
                    <div class="desc">6% unemployment with interventions</div>
                </button>
            </div>

            <!-- Interventions -->
            <div class="sidebar-section">
                <h3>Policy Interventions</h3>
                <div id="interventionsList"></div>
                <button class="btn btn-outline btn-block btn-sm" onclick="showInterventionModal()">
                    + Add Intervention
                </button>
            </div>

            <!-- Run Simulation -->
            <div class="sidebar-section">
                <button class="btn btn-primary btn-block btn-lg" onclick="runSimulation()">
                    Run Simulation
                </button>
                <button class="btn btn-block btn-lg ai-sim-btn" onclick="runAdvancedAISimulation()" style="margin-top: 8px; background: linear-gradient(135deg, #6366f1, #8b5cf6); border: none;">
                    <span style="margin-right: 6px;">‚ú®</span> Advanced AI Simulation
                </button>
                <div style="display: flex; gap: 8px; margin-top: 8px;">
                    <button class="btn btn-outline btn-block" onclick="resetToDefaults()">
                        Reset
                    </button>
                    <button class="btn btn-outline btn-block" onclick="copyScenarioURL()" title="Copy shareable URL">
                        Share URL
                    </button>
                </div>
            </div>

            <!-- AI Model Status -->
            <div class="sidebar-section" id="ai-model-status-section">
                <h3>AI Model</h3>
                <div id="aiModelStatus">
                    <p style="font-size: 0.75rem; color: var(--gray-400);">No AI simulations yet</p>
                </div>
                <button class="btn btn-sm btn-outline btn-block" onclick="showTrainingModal()" style="margin-top: 8px;">
                    Train Model
                </button>
            </div>

            <!-- Saved Simulations -->
            <div class="sidebar-section">
                <h3>Saved Simulations</h3>
                <div id="savedSimulationsList">
                    <p style="font-size: 0.875rem; color: var(--gray-400);">No saved simulations</p>
                </div>
            </div>

            <!-- Author Credit & Contact -->
            <div class="sidebar-section" style="margin-top: auto; border-top: 1px solid var(--gray-700); padding-top: 16px;">
                <div style="text-align: center;">
                    <p style="font-size: 0.875rem; color: var(--gray-400); margin-bottom: 12px;">
                        A project by <a href="https://adamconner.com" target="_blank" style="color: var(--primary); text-decoration: none; font-weight: 500;">Adam Conner</a>
                    </p>
                    <a href="mailto:contact@adamconner.com" class="btn btn-outline btn-block btn-sm" style="border-color: var(--gray-600); color: var(--gray-300);">
                        Contact Me
                    </a>
                </div>
            </div>

        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="header">
                <button class="mobile-menu-toggle" id="mobileMenuToggle" onclick="openMobileMenu()" aria-label="Open menu">
                    <span class="menu-icon">‚ò∞</span>
                    <span class="menu-label">Configure</span>
                </button>
                <h1>AI Labor Market Impact Analysis</h1>
                <div class="header-actions">
                    <button class="btn btn-success" onclick="saveSimulation()">Save Simulation</button>
                    <button class="btn btn-primary" onclick="shareSimulation()" id="shareBtn" style="display: none;">Share Publicly</button>
                    <button class="btn btn-outline" onclick="exportResults()">Export Results</button>
                    <button class="btn btn-outline" onclick="showHistoryModal()" id="historyBtn" title="View simulation history">
                        <span>üìú</span> History
                    </button>
                    <button class="theme-toggle" onclick="toggleTheme()" id="themeToggle" title="Toggle dark mode">
                        <span id="themeIcon">üåô</span>
                    </button>
                    <button class="btn btn-secondary" onclick="resetToDefaults()">Reset to Defaults</button>
                </div>
            </header>

            <!-- Navigation Tabs -->
            <nav class="nav-tabs">
                <button class="nav-tab active" onclick="showSection('snapshot')">Current Snapshot</button>
                <button class="nav-tab" onclick="showSection('realmetrics')">Real Economic Metrics</button>
                <button class="nav-tab" onclick="showSection('indicators')">AI Indicators</button>
                <button class="nav-tab" onclick="showSection('simulation')">Simulation Results</button>
                <button class="nav-tab" onclick="showSection('comparison')">Compare Scenarios</button>
                <button class="nav-tab" onclick="showSection('occupations')">Occupations</button>
                <button class="nav-tab" onclick="showSection('sectors')">Sector Analysis</button>
                <button class="nav-tab" onclick="showSection('sensitivity')">Sensitivity</button>
                <button class="nav-tab" onclick="showSection('interventions')">Intervention Impact</button>
                <button class="nav-tab" onclick="showSection('settings')">Settings</button>
            </nav>

            <!-- Current Snapshot Section -->
            <section id="snapshot-section" class="section active">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="label">Unemployment Rate</div>
                        <div class="value" id="stat-ur">4.1%</div>
                        <div class="change positive">‚Üì 0.2% from last month</div>
                    </div>
                    <div class="stat-card">
                        <div class="label">Total Employment</div>
                        <div class="value" id="stat-emp">161.2M</div>
                        <div class="change positive">‚Üë +145K jobs</div>
                    </div>
                    <div class="stat-card">
                        <div class="label">Labor Force Participation</div>
                        <div class="value" id="stat-lfpr">62.6%</div>
                        <div class="change">Unchanged</div>
                    </div>
                    <div class="stat-card">
                        <div class="label">Job Openings</div>
                        <div class="value" id="stat-jo">7.4M</div>
                        <div class="change negative">‚Üì -1.8M YoY</div>
                    </div>
                </div>

                <div class="card-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3>Historical Unemployment Trend</h3>
                        </div>
                        <div class="chart-container">
                            <canvas id="historicalChart"></canvas>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <h3>Labor Market Health</h3>
                        </div>
                        <div class="indicator-list">
                            <div class="indicator-item">
                                <div>
                                    <div class="indicator-name">Average Hourly Earnings</div>
                                    <div class="indicator-source">BLS, Oct 2024</div>
                                </div>
                                <div class="indicator-value">$35.46</div>
                            </div>
                            <div class="indicator-item">
                                <div>
                                    <div class="indicator-name">Real Wage Growth</div>
                                    <div class="indicator-source">BLS, Oct 2024</div>
                                </div>
                                <div class="indicator-value">+1.4%</div>
                            </div>
                            <div class="indicator-item">
                                <div>
                                    <div class="indicator-name">Productivity Growth</div>
                                    <div class="indicator-source">BLS, Q3 2024</div>
                                </div>
                                <div class="indicator-value">+2.2%</div>
                            </div>
                            <div class="indicator-item">
                                <div>
                                    <div class="indicator-name">Quits Rate</div>
                                    <div class="indicator-source">JOLTS, Sep 2024</div>
                                </div>
                                <div class="indicator-value">2.1%</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>Employment by Sector</h3>
                    </div>
                    <div class="chart-container large">
                        <canvas id="sectorEmploymentChart"></canvas>
                    </div>
                </div>
            </section>

            <!-- Real Metrics Section -->
            <section id="realmetrics-section" class="section">
                <!-- Real Economic Indicators -->
                <div class="card" style="margin-bottom: 24px; border-left: 4px solid var(--secondary);">
                    <div class="card-header" style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 12px;">
                        <div>
                            <h3>Real Economic Metrics</h3>
                            <p style="font-size: 0.75rem; color: var(--gray-500); margin-top: 4px;">
                                Actual government data from BLS, FRED, Census, and other official sources
                            </p>
                        </div>
                        <div style="display: flex; gap: 8px;">
                            <span class="tag tag-low">Verified Sources</span>
                            <button class="btn btn-sm btn-outline" onclick="resetAllRealMetrics()">Reset All</button>
                        </div>
                    </div>

                    <div id="realMetricsList" style="margin-top: 16px;">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>

                <!-- Data Sources Reference -->
                <div class="card">
                    <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
                        <h3>Data Sources & Methodology</h3>
                        <button class="btn btn-sm btn-outline" onclick="toggleRealMetricsSourcesDetails()">Show Details</button>
                    </div>
                    <div id="realMetricsSourcesDetails" style="display: none; margin-top: 16px;">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Source</th>
                                    <th>Type</th>
                                    <th>Data Provided</th>
                                    <th>Update Frequency</th>
                                    <th>Link</th>
                                </tr>
                            </thead>
                            <tbody id="realMetricsSourcesTable">
                                <!-- Populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- AI Indicators Section -->
            <section id="indicators-section" class="section">
                <!-- Real Indicators (Current Data) -->
                <div class="card" style="margin-bottom: 24px;">
                    <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
                        <h3>Real AI Indicators (Current Data)</h3>
                        <span class="tag tag-low">Verified Sources</span>
                    </div>
                    <div class="stats-grid" style="margin-top: 16px;">
                        <div class="stat-card">
                            <div class="label">Companies Using AI</div>
                            <div class="value">35%</div>
                            <div class="change positive">‚Üë McKinsey Survey</div>
                        </div>
                        <div class="stat-card">
                            <div class="label">AI Investment (2024)</div>
                            <div class="value">$189B</div>
                            <div class="change positive">Stanford AI Index</div>
                        </div>
                        <div class="stat-card">
                            <div class="label">GenAI Weekly Users</div>
                            <div class="value">23%</div>
                            <div class="change positive">Census RPS Survey</div>
                        </div>
                        <div class="stat-card">
                            <div class="label">AI Job Postings</div>
                            <div class="value">2.3%</div>
                            <div class="change">Indeed/LinkedIn</div>
                        </div>
                    </div>
                </div>

                <!-- Hypothetical Indicators -->
                <div class="card" style="margin-bottom: 24px; border-left: 4px solid var(--warning);">
                    <div class="card-header" style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 12px;">
                        <div>
                            <h3>Hypothetical AI Impact Indicators</h3>
                            <p style="font-size: 0.75rem; color: var(--gray-500); margin-top: 4px;">
                                Research-based metrics that would measure AI's labor market impact if tracked systematically
                            </p>
                        </div>
                        <div style="display: flex; gap: 8px;">
                            <button class="btn btn-sm btn-outline" onclick="resetAllHypotheticalIndicators()">Reset All</button>
                            <button class="btn btn-sm btn-primary" onclick="showCustomIndicatorModal()">+ Add Custom</button>
                        </div>
                    </div>

                    <div id="hypotheticalIndicatorsList" style="margin-top: 16px;">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>

                <!-- Data Sources Reference -->
                <div class="card">
                    <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
                        <h3>Research Sources & Methodology</h3>
                        <button class="btn btn-sm btn-outline" onclick="toggleSourcesDetails()">Show Details</button>
                    </div>
                    <div id="sourcesDetails" style="display: none; margin-top: 16px;">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Source</th>
                                    <th>Organization</th>
                                    <th>Indicators Derived</th>
                                    <th>Link</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Anthropic Economic Index</strong></td>
                                    <td>Anthropic</td>
                                    <td>Task Automation Rate, Human-AI Collaboration</td>
                                    <td><a href="https://www.anthropic.com/economic-index" target="_blank" style="color: var(--primary);">View</a></td>
                                </tr>
                                <tr>
                                    <td><strong>Iceberg Index</strong></td>
                                    <td>MIT / Oak Ridge</td>
                                    <td>Skills Transformation Score</td>
                                    <td><a href="https://iceberg.mit.edu" target="_blank" style="color: var(--primary);">View</a></td>
                                </tr>
                                <tr>
                                    <td><strong>AIOE Index</strong></td>
                                    <td>Felten, Raj, Seamans</td>
                                    <td>AI Occupational Exposure</td>
                                    <td><a href="https://www.aeaweb.org/articles?id=10.1257/pandp.20181019" target="_blank" style="color: var(--primary);">View</a></td>
                                </tr>
                                <tr>
                                    <td><strong>Budget Lab Analysis</strong></td>
                                    <td>Yale</td>
                                    <td>Job Displacement Velocity</td>
                                    <td><a href="https://budgetlab.yale.edu" target="_blank" style="color: var(--primary);">View</a></td>
                                </tr>
                                <tr>
                                    <td><strong>IMF Working Papers</strong></td>
                                    <td>IMF</td>
                                    <td>Regional Vulnerability, Labor Share</td>
                                    <td><a href="https://www.imf.org/en/Publications/WP" target="_blank" style="color: var(--primary);">View</a></td>
                                </tr>
                                <tr>
                                    <td><strong>GenAI & Jobs Report</strong></td>
                                    <td>ILO</td>
                                    <td>Human-AI Collaboration Index</td>
                                    <td><a href="https://www.ilo.org" target="_blank" style="color: var(--primary);">View</a></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Simulation Results Section -->
            <section id="simulation-section" class="section">
                <div id="simulation-results">
                    <div class="card" style="text-align: center; padding: 60px;">
                        <h3 style="margin-bottom: 16px;">No Simulation Run Yet</h3>
                        <p style="color: var(--gray-500); margin-bottom: 24px;">
                            Configure your scenario parameters and click "Run Simulation" to see projected impacts.
                        </p>
                        <button class="btn btn-primary" onclick="runSimulation()">Run Simulation</button>
                    </div>
                </div>
            </section>

            <!-- Scenario Comparison Section -->
            <section id="comparison-section" class="section">
                <div class="card" style="margin-bottom: 24px;">
                    <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <h3>Scenario Comparison</h3>
                            <p style="font-size: 0.875rem; color: var(--gray-500); margin-top: 4px;">
                                Compare up to 3 scenarios side-by-side to analyze different outcomes
                            </p>
                        </div>
                        <div style="display: flex; gap: 8px;">
                            <span id="comparisonCount" class="tag tag-medium">0/3 scenarios</span>
                            <button class="btn btn-sm btn-outline" onclick="clearAllComparisons()" id="clearComparisonBtn" style="display: none;">
                                Clear All
                            </button>
                        </div>
                    </div>
                </div>
                <div id="comparison-content">
                    <div class="card" style="text-align: center; padding: 60px;">
                        <h3 style="margin-bottom: 16px;">No Scenarios to Compare</h3>
                        <p style="color: var(--gray-500); margin-bottom: 24px;">
                            Run simulations and click "Add to Comparison" to compare scenarios side-by-side.
                        </p>
                        <button class="btn btn-primary" onclick="showSection('simulation'); document.querySelectorAll('.nav-tab')[3].click();">
                            Run a Simulation
                        </button>
                    </div>
                </div>
            </section>

            <!-- Occupations Drill-Down Section -->
            <section id="occupations-section" class="section">
                <div class="card" style="margin-bottom: 24px;">
                    <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <h3>Occupation-Level AI Impact Analysis</h3>
                            <p style="font-size: 0.875rem; color: var(--gray-500); margin-top: 4px;">
                                Explore how AI may impact specific occupations based on O*NET task analysis
                            </p>
                        </div>
                    </div>
                </div>
                <div id="occupation-content">
                    <!-- Populated by JavaScript -->
                </div>
            </section>

            <!-- Sector Analysis Section -->
            <section id="sectors-section" class="section">
                <div class="card">
                    <div class="card-header">
                        <h3>Sector Automation Exposure</h3>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Sector</th>
                                <th>Employment</th>
                                <th>Automation Exposure</th>
                                <th>Risk Level</th>
                                <th>Jobs at Risk</th>
                            </tr>
                        </thead>
                        <tbody id="sectorTableBody">
                            <!-- Populated by JavaScript -->
                        </tbody>
                    </table>
                </div>

                <div class="card-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3>Employment by Risk Level</h3>
                        </div>
                        <div class="chart-container">
                            <canvas id="riskLevelChart"></canvas>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <h3>Jobs at Risk Summary</h3>
                        </div>
                        <div class="indicator-list" id="riskSummary">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Sensitivity Analysis Section -->
            <section id="sensitivity-section" class="section">
                <div id="sensitivity-content">
                    <!-- Populated by JavaScript -->
                </div>
            </section>

            <!-- Intervention Impact Section -->
            <section id="interventions-section" class="section">
                <div class="card">
                    <div class="card-header">
                        <h3>Available Policy Interventions</h3>
                    </div>
                    <div class="card-grid" id="interventionTypes">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>

                <div id="intervention-results" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <h3>Intervention Impact Analysis</h3>
                        </div>
                        <div class="chart-container large">
                            <canvas id="interventionChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Settings Section -->
            <section id="settings-section" class="section">
                <div class="card" style="margin-bottom: 24px;">
                    <div class="card-header">
                        <h3>API Settings</h3>
                        <p style="font-size: 0.875rem; color: var(--gray-500); margin-top: 4px;">
                            Configure API keys to enable live data fetching and AI-powered analysis
                        </p>
                    </div>

                    <div style="margin-top: 20px;">
                        <!-- BLS API Key -->
                        <div style="background: var(--gray-50); border: 1px solid var(--gray-200); border-radius: 8px; padding: 20px; margin-bottom: 16px;">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                                <div>
                                    <h4 style="color: var(--gray-800); margin-bottom: 4px;">Bureau of Labor Statistics (BLS) API</h4>
                                    <p style="font-size: 0.75rem; color: var(--gray-500);">
                                        Access live employment, unemployment, and wage data
                                    </p>
                                </div>
                                <span id="blsApiStatus" class="tag tag-low">Not Configured</span>
                            </div>
                            <div class="form-group" style="margin-bottom: 12px;">
                                <label style="color: var(--gray-700); font-size: 0.875rem;">API Key</label>
                                <input type="password" id="blsApiKey" placeholder="Enter your BLS API key"
                                       style="color: var(--gray-900); width: 100%; padding: 10px; border: 1px solid var(--gray-300); border-radius: 6px;">
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <a href="https://www.bls.gov/developers/" target="_blank" style="font-size: 0.75rem; color: var(--primary);">
                                    Get free API key from BLS
                                </a>
                                <div style="display: flex; gap: 8px;">
                                    <button class="btn btn-sm btn-outline" onclick="clearApiKey('bls')">Clear</button>
                                    <button class="btn btn-sm btn-primary" onclick="saveApiKey('bls')">Save Key</button>
                                </div>
                            </div>
                        </div>

                        <!-- FRED API Key -->
                        <div style="background: var(--gray-50); border: 1px solid var(--gray-200); border-radius: 8px; padding: 20px; margin-bottom: 16px;">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                                <div>
                                    <h4 style="color: var(--gray-800); margin-bottom: 4px;">Federal Reserve Economic Data (FRED) API</h4>
                                    <p style="font-size: 0.75rem; color: var(--gray-500);">
                                        Access GDP, interest rates, and macroeconomic indicators
                                    </p>
                                </div>
                                <span id="fredApiStatus" class="tag tag-low">Not Configured</span>
                            </div>
                            <div class="form-group" style="margin-bottom: 12px;">
                                <label style="color: var(--gray-700); font-size: 0.875rem;">API Key</label>
                                <input type="password" id="fredApiKey" placeholder="Enter your FRED API key"
                                       style="color: var(--gray-900); width: 100%; padding: 10px; border: 1px solid var(--gray-300); border-radius: 6px;">
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <a href="https://fred.stlouisfed.org/docs/api/api_key.html" target="_blank" style="font-size: 0.75rem; color: var(--primary);">
                                    Get free API key from FRED
                                </a>
                                <div style="display: flex; gap: 8px;">
                                    <button class="btn btn-sm btn-outline" onclick="clearApiKey('fred')">Clear</button>
                                    <button class="btn btn-sm btn-primary" onclick="saveApiKey('fred')">Save Key</button>
                                </div>
                            </div>
                        </div>

                        <!-- Gemini API Key -->
                        <div style="background: var(--gray-50); border: 1px solid var(--gray-200); border-radius: 8px; padding: 20px; margin-bottom: 16px;">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                                <div>
                                    <h4 style="color: var(--gray-800); margin-bottom: 4px;">Google Gemini AI API</h4>
                                    <p style="font-size: 0.75rem; color: var(--gray-500);">
                                        Enable AI-powered analysis and summaries of simulation results
                                    </p>
                                </div>
                                <span id="geminiApiStatus" class="tag tag-low">Not Configured</span>
                            </div>
                            <div class="form-group" style="margin-bottom: 12px;">
                                <label style="color: var(--gray-700); font-size: 0.875rem;">API Key</label>
                                <input type="password" id="geminiApiKeySettings" placeholder="Enter your Gemini API key"
                                       style="color: var(--gray-900); width: 100%; padding: 10px; border: 1px solid var(--gray-300); border-radius: 6px;">
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <a href="https://makersuite.google.com/app/apikey" target="_blank" style="font-size: 0.75rem; color: var(--primary);">
                                    Get free API key from Google AI Studio
                                </a>
                                <div style="display: flex; gap: 8px;">
                                    <button class="btn btn-sm btn-outline" onclick="clearApiKey('gemini')">Clear</button>
                                    <button class="btn btn-sm btn-primary" onclick="saveApiKey('gemini')">Save Key</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Auto-Updated Data Status -->
                <div class="card" style="margin-bottom: 24px; border-left: 4px solid var(--secondary);">
                    <div class="card-header">
                        <h3>Economic Data Status</h3>
                        <p style="font-size: 0.875rem; color: var(--gray-500); margin-top: 4px;">
                            Data is automatically updated daily from BLS and FRED
                        </p>
                    </div>
                    <div style="margin-top: 20px;">
                        <div id="autoDataStatus" style="background: var(--gray-50); border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                            <!-- Populated by JavaScript -->
                            <p style="color: var(--gray-600); font-size: 0.875rem;">
                                <strong>Loading data status...</strong>
                            </p>
                        </div>
                        <p style="font-size: 0.75rem; color: var(--gray-500); margin-bottom: 16px;">
                            Economic data from BLS and FRED is automatically fetched daily via GitHub Actions
                            and made available to all users. No API key required.
                        </p>
                    </div>
                </div>

                <!-- Manual Live Data Controls -->
                <div class="card" style="margin-bottom: 24px;">
                    <div class="card-header">
                        <h3>Manual Data Refresh</h3>
                        <p style="font-size: 0.875rem; color: var(--gray-500); margin-top: 4px;">
                            Optionally fetch live data directly using your own API keys
                        </p>
                    </div>
                    <div style="margin-top: 20px;">
                        <div id="liveDataStatus" style="background: var(--gray-50); border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                            <p style="color: var(--gray-600); font-size: 0.875rem;">
                                <strong>Manual Fetch:</strong> Use your own API keys to fetch the latest data on demand
                            </p>
                            <p style="color: var(--gray-500); font-size: 0.75rem; margin-top: 8px;">
                                Configure BLS and/or FRED API keys above to enable manual data fetching.
                            </p>
                        </div>
                        <div style="display: flex; gap: 12px; flex-wrap: wrap;">
                            <button class="btn btn-primary" onclick="fetchLiveData()" id="fetchLiveDataBtn" disabled>
                                Fetch Live Data
                            </button>
                            <button class="btn btn-outline" onclick="resetToBaselineData()">
                                Reset to Baseline Data
                            </button>
                        </div>
                        <div id="fetchProgress" style="margin-top: 16px; display: none;">
                            <div class="loading">
                                <div class="spinner"></div>
                                <span id="fetchProgressText">Fetching data...</span>
                            </div>
                        </div>
                        <div id="fetchResults" style="margin-top: 16px;"></div>
                    </div>
                </div>

                <!-- Data Storage Info -->
                <div class="card">
                    <div class="card-header">
                        <h3>Data Privacy & Storage</h3>
                    </div>
                    <div style="margin-top: 16px; color: var(--gray-600); font-size: 0.875rem; line-height: 1.6;">
                        <p style="margin-bottom: 12px;">
                            <strong>API Keys:</strong> All API keys are stored locally in your browser's localStorage.
                            They are never sent to any server except the respective API providers (BLS, FRED, Google).
                        </p>
                        <p style="margin-bottom: 12px;">
                            <strong>Simulations:</strong> Your saved simulations and settings are stored locally in your browser.
                        </p>
                        <p>
                            <strong>Clearing Data:</strong> Use your browser's "Clear site data" feature to remove all stored data,
                            or use the individual "Clear" buttons above to remove specific API keys.
                        </p>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Intervention Modal -->
    <div id="interventionModal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center;">
        <div style="background: white; border-radius: 8px; padding: 24px; max-width: 500px; width: 90%;">
            <h3 style="margin-bottom: 16px;">Add Policy Intervention</h3>
            <div class="form-group">
                <label style="color: var(--gray-700);">Intervention Type</label>
                <select id="interventionType" onchange="updateInterventionParams()" style="color: var(--gray-900);">
                    <option value="ubi">Universal Basic Income</option>
                    <option value="job_retraining">Job Retraining Programs</option>
                    <option value="wage_subsidy">Wage Subsidies</option>
                    <option value="reduced_workweek">Reduced Work Week</option>
                    <option value="robot_tax">Automation Tax</option>
                    <option value="education_subsidy">Education Subsidy</option>
                    <option value="job_guarantee">Federal Job Guarantee</option>
                    <option value="transition_assistance">Transition Assistance</option>
                </select>
            </div>
            <div id="interventionParams"></div>
            <div style="display: flex; gap: 12px; margin-top: 24px;">
                <button class="btn btn-primary" onclick="addIntervention()">Add Intervention</button>
                <button class="btn btn-secondary" onclick="hideInterventionModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Saved Simulations Modal -->
    <div id="savedSimulationsModal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center;">
        <div style="background: var(--gray-100); border-radius: 8px; padding: 24px; max-width: 700px; width: 90%; max-height: 80vh; overflow-y: auto;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h3>Saved Simulations</h3>
                <button class="btn btn-secondary btn-sm" onclick="hideSavedSimulationsModal()">Close</button>
            </div>
            <div id="savedSimulationsContent">
                <!-- Populated by JavaScript -->
            </div>
            <div style="margin-top: 20px; padding-top: 16px; border-top: 1px solid var(--gray-300); display: flex; justify-content: space-between;">
                <button class="btn btn-danger btn-sm" onclick="clearAllSavedSimulations()">Delete All Saved Simulations</button>
                <button class="btn btn-secondary" onclick="hideSavedSimulationsModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- Custom Indicator Modal -->
    <div id="customIndicatorModal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center;">
        <div style="background: white; border-radius: 8px; padding: 24px; max-width: 600px; width: 90%; max-height: 85vh; overflow-y: auto;">
            <h3 style="margin-bottom: 16px; color: var(--gray-800);">Add Custom Indicator</h3>
            <p style="font-size: 0.875rem; color: var(--gray-600); margin-bottom: 16px;">
                Create your own hypothetical indicator to track in the simulation.
            </p>

            <div class="form-group">
                <label style="color: var(--gray-700);">Indicator Name *</label>
                <input type="text" id="customIndName" placeholder="e.g., AI Freelancer Displacement Rate"
                       style="color: var(--gray-900); width: 100%; padding: 10px; border: 1px solid var(--gray-300); border-radius: 6px;">
            </div>

            <div class="form-group">
                <label style="color: var(--gray-700);">Short Name (4 chars)</label>
                <input type="text" id="customIndShortName" placeholder="e.g., AFDR" maxlength="6"
                       style="color: var(--gray-900); width: 100%; padding: 10px; border: 1px solid var(--gray-300); border-radius: 6px;">
            </div>

            <div class="form-group">
                <label style="color: var(--gray-700);">Description</label>
                <textarea id="customIndDescription" placeholder="What does this indicator measure?"
                          style="color: var(--gray-900); width: 100%; padding: 10px; border: 1px solid var(--gray-300); border-radius: 6px; min-height: 60px;"></textarea>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                <div class="form-group">
                    <label style="color: var(--gray-700);">Initial Value *</label>
                    <input type="number" id="customIndValue" placeholder="0" step="0.1"
                           style="color: var(--gray-900); width: 100%; padding: 10px; border: 1px solid var(--gray-300); border-radius: 6px;">
                </div>

                <div class="form-group">
                    <label style="color: var(--gray-700);">Unit</label>
                    <select id="customIndUnit" style="color: var(--gray-900); width: 100%; padding: 10px; border: 1px solid var(--gray-300); border-radius: 6px;">
                        <option value="percent">Percent (%)</option>
                        <option value="index_0_100">Index (0-100)</option>
                        <option value="millions">Millions</option>
                        <option value="thousands">Thousands</option>
                        <option value="ratio">Ratio</option>
                        <option value="currency">Currency ($)</option>
                    </select>
                </div>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                <div class="form-group">
                    <label style="color: var(--gray-700);">Min Value</label>
                    <input type="number" id="customIndMin" placeholder="0" step="0.1"
                           style="color: var(--gray-900); width: 100%; padding: 10px; border: 1px solid var(--gray-300); border-radius: 6px;">
                </div>

                <div class="form-group">
                    <label style="color: var(--gray-700);">Max Value</label>
                    <input type="number" id="customIndMax" placeholder="100" step="0.1"
                           style="color: var(--gray-900); width: 100%; padding: 10px; border: 1px solid var(--gray-300); border-radius: 6px;">
                </div>
            </div>

            <div class="form-group">
                <label style="color: var(--gray-700);">Category</label>
                <select id="customIndCategory" style="color: var(--gray-900); width: 100%; padding: 10px; border: 1px solid var(--gray-300); border-radius: 6px;">
                    <option value="custom">Custom</option>
                    <option value="automation">Task Automation</option>
                    <option value="displacement">Job Displacement</option>
                    <option value="creation">Job Creation</option>
                    <option value="wages">Wage Impacts</option>
                    <option value="skills">Skills & Training</option>
                    <option value="geographic">Geographic Impact</option>
                </select>
            </div>

            <div class="form-group">
                <label style="color: var(--gray-700);">Linked Real Metrics (affects how this changes)</label>
                <div style="display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px;">
                    <label style="display: flex; align-items: center; gap: 4px; font-size: 0.875rem; color: var(--gray-600);">
                        <input type="checkbox" id="link_unemployment" value="unemployment_rate"> Unemployment Rate
                    </label>
                    <label style="display: flex; align-items: center; gap: 4px; font-size: 0.875rem; color: var(--gray-600);">
                        <input type="checkbox" id="link_ai_adoption" value="ai_adoption"> AI Adoption
                    </label>
                    <label style="display: flex; align-items: center; gap: 4px; font-size: 0.875rem; color: var(--gray-600);">
                        <input type="checkbox" id="link_productivity" value="productivity_growth"> Productivity
                    </label>
                    <label style="display: flex; align-items: center; gap: 4px; font-size: 0.875rem; color: var(--gray-600);">
                        <input type="checkbox" id="link_wages" value="wage_growth"> Wage Growth
                    </label>
                </div>
            </div>

            <div class="form-group">
                <label style="color: var(--gray-700);">Icon</label>
                <select id="customIndIcon" style="color: var(--gray-900); width: 100%; padding: 10px; border: 1px solid var(--gray-300); border-radius: 6px;">
                    <option value="üìä">üìä Chart</option>
                    <option value="üìà">üìà Growth</option>
                    <option value="üìâ">üìâ Decline</option>
                    <option value="üéØ">üéØ Target</option>
                    <option value="üíº">üíº Jobs</option>
                    <option value="üí∞">üí∞ Money</option>
                    <option value="ü§ñ">ü§ñ Robot</option>
                    <option value="‚ö°">‚ö° Speed</option>
                    <option value="üå±">üå± Growth</option>
                    <option value="‚ö†Ô∏è">‚ö†Ô∏è Warning</option>
                    <option value="üìå">üìå Pin</option>
                </select>
            </div>

            <div style="display: flex; gap: 12px; margin-top: 24px;">
                <button class="btn btn-primary" onclick="saveCustomIndicator()">Add Indicator</button>
                <button class="btn btn-secondary" onclick="hideCustomIndicatorModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- AI Settings Modal -->
    <div id="aiSettingsModal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center;">
        <div style="background: white; border-radius: 8px; padding: 24px; max-width: 500px; width: 90%;">
            <h3 style="margin-bottom: 16px; color: var(--gray-800);">Configure AI Analysis</h3>
            <p style="font-size: 0.875rem; color: var(--gray-600); margin-bottom: 16px;">
                Add your Gemini API key to enable AI-powered analysis of simulation results.
                The key is stored locally in your browser and never sent to any server except Google's API.
            </p>
            <div class="form-group">
                <label style="color: var(--gray-700);">Gemini API Key</label>
                <input type="password" id="geminiApiKey" placeholder="Enter your Gemini API key"
                       style="color: var(--gray-900); width: 100%; padding: 10px; border: 1px solid var(--gray-300); border-radius: 6px;">
            </div>
            <p style="font-size: 0.75rem; color: var(--gray-500); margin-bottom: 16px;">
                Get a free API key from <a href="https://makersuite.google.com/app/apikey" target="_blank" style="color: var(--primary);">Google AI Studio</a>
            </p>
            <div style="display: flex; gap: 12px; margin-top: 24px;">
                <button class="btn btn-primary" onclick="saveAIApiKey()">Save API Key</button>
                <button class="btn btn-secondary" onclick="hideAISettingsModal()">Cancel</button>
                <button class="btn btn-danger" onclick="clearAIApiKey()" style="margin-left: auto;">Clear Key</button>
            </div>
        </div>
    </div>

    <!-- Simulation History Modal -->
    <div id="historyModal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center;">
        <div style="background: var(--bg-card, white); border-radius: 8px; padding: 24px; max-width: 700px; width: 95%; max-height: 85vh; overflow-y: auto;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                <h3 style="color: var(--text-primary, var(--gray-800));">Simulation History</h3>
                <button onclick="hideHistoryModal()" style="background: none; border: none; font-size: 1.5rem; cursor: pointer; color: var(--text-secondary, var(--gray-500));">&times;</button>
            </div>
            <p style="font-size: 0.875rem; color: var(--text-muted, var(--gray-500)); margin-bottom: 16px;">
                Your recent simulation runs are saved locally. Click on any to reload it.
            </p>
            <div id="historyList">
                <!-- History items will be inserted here -->
            </div>
            <div style="display: flex; gap: 12px; margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--border-color, var(--gray-200));">
                <button class="btn btn-secondary" onclick="hideHistoryModal()">Close</button>
                <button class="btn btn-danger" onclick="clearAllHistory()" style="margin-left: auto;">Clear All History</button>
            </div>
        </div>
    </div>

    <!-- Password Modal for Advanced AI Simulation -->
    <div id="passwordModal" class="modal-overlay" style="display: none;">
        <div class="modal-content" style="max-width: 400px;">
            <h3 style="margin-bottom: 16px;">Advanced AI Simulation</h3>
            <p style="color: var(--gray-500); margin-bottom: 16px; font-size: 0.875rem;">
                Enter the password to access AI-enhanced simulation features.
            </p>
            <div class="form-group">
                <label>Password</label>
                <input type="password" id="aiSimPassword" placeholder="Enter password" style="width: 100%;">
            </div>
            <div id="passwordError" style="color: var(--danger); font-size: 0.875rem; margin-bottom: 12px; display: none;">
                Incorrect password. Please try again.
            </div>
            <div style="display: flex; gap: 12px; margin-top: 16px;">
                <button class="btn btn-primary" onclick="submitAIPassword()">Continue</button>
                <button class="btn btn-secondary" onclick="hidePasswordModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- AI Training Modal -->
    <div id="trainingModal" class="modal-overlay" style="display: none;">
        <div class="modal-content" style="max-width: 600px;">
            <h3 style="margin-bottom: 16px;">AI Model Training</h3>
            <div id="trainingStatus">
                <div class="training-stats" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-bottom: 20px;">
                    <div class="stat-box" style="background: var(--gray-50); padding: 16px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 0.75rem; color: var(--gray-500); text-transform: uppercase;">Stored Simulations</div>
                        <div id="trainSimCount" style="font-size: 1.5rem; font-weight: bold; color: var(--primary);">0</div>
                    </div>
                    <div class="stat-box" style="background: var(--gray-50); padding: 16px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 0.75rem; color: var(--gray-500); text-transform: uppercase;">Model Version</div>
                        <div id="trainModelVersion" style="font-size: 1.5rem; font-weight: bold; color: var(--secondary);">-</div>
                    </div>
                    <div class="stat-box" style="background: var(--gray-50); padding: 16px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 0.75rem; color: var(--gray-500); text-transform: uppercase;">Confidence</div>
                        <div id="trainConfidence" style="font-size: 1.5rem; font-weight: bold; color: var(--warning);">-</div>
                    </div>
                </div>
                <div id="trainingMessage" style="padding: 12px; background: var(--gray-100); border-radius: 6px; margin-bottom: 16px; font-size: 0.875rem;">
                    Run at least 3 AI-enhanced simulations to enable model training.
                </div>
            </div>
            <div style="display: flex; gap: 12px; flex-wrap: wrap;">
                <button id="trainModelBtn" class="btn btn-primary" onclick="trainModel()" disabled>
                    Train Model
                </button>
                <button class="btn btn-outline" onclick="exportTrainingData()">
                    Export Data
                </button>
                <button class="btn btn-secondary" onclick="hideTrainingModal()" style="margin-left: auto;">
                    Close
                </button>
            </div>
        </div>
    </div>

    <!-- AI Simulation Results Modal -->
    <div id="aiResultsModal" class="modal-overlay" style="display: none;">
        <div class="modal-content" style="max-width: 900px; max-height: 90vh; overflow-y: auto;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                <h3>AI-Enhanced Analysis</h3>
                <button class="btn btn-sm btn-secondary" onclick="hideAIResultsModal()">Close</button>
            </div>
            <div id="aiResultsContent">
                <!-- AI analysis will be inserted here -->
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="src/data/economic-data.js"></script>
    <script src="src/models/indicators.js"></script>
    <script src="src/models/real-metrics.js"></script>
    <script src="src/models/hypothetical-indicators.js"></script>
    <script src="src/simulation/engine.js"></script>
    <script src="src/simulation/interventions.js"></script>
    <script src="src/utils/calculations.js"></script>
    <script src="src/components/visualizations.js"></script>
    <script src="src/services/ai-summary.js"></script>
    <script src="src/services/ai-scenario-enhancer.js"></script>
    <script src="src/services/model-trainer.js"></script>
    <script src="src/services/simulation-sharing.js"></script>
    <script src="src/services/simulation-history.js"></script>
    <script src="src/features/scenario-comparison.js"></script>
    <script src="src/features/occupation-drilldown.js"></script>
    <script src="src/features/pdf-export.js"></script>
    <script src="src/features/sensitivity-analysis.js"></script>
    <script src="src/features/monte-carlo.js"></script>
    <script src="src/features/intervention-cost-calculator.js"></script>
    <script src="src/features/timeline-player.js"></script>
    <script src="src/features/url-sharing.js"></script>
    <script src="src/app.js"></script>
</body>
</html>
